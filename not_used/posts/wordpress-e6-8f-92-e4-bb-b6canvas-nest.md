---
title: wordpress插件canvas-nest
tags:
  - wordpress
url: 126.html
id: 126
categories:
  - Wordpress
date: 2018-04-14 07:57:31
---

canvas-nest.js是一个基于canvas动态绘制的网页背景效果，具体效果可以查看本站背景。鼠标在上面拖动可以绘制图形，当鼠标移开的时候，会绽放，超级炫酷。我们具体来看一下这个[wordpress插件canvas-nest](http://www.bangyouseo.com/tag/wordpress-cj-canvas-nest/ "【查看含有[wordpress插件canvas-nest]标签的文章】") \[caption id="attachment_14512" align="alignnone" width="600"\]![wordpress插件canvas-nest效果](http://blog.echo.cool/wp-content/uploads/2018/05/unnamed-file-20.png) wordpress插件canvas-nest效果\[/caption\] **canvas-nest.js源码：**

> function() { //封装方法，压缩之后减少文件大小 function get\_attribute(node, attr, default\_value) { return node.getAttribute(attr) || default\_value; } //封装方法，压缩之后减少文件大小 function get\_by\_tagname(name) { return document.getElementsByTagName(name); } //获取配置参数 function get\_config\_option() { var scripts = get\_by\_tagname("script"), script\_len = scripts.length, script = scripts\[script\_len - 1\]; //当前加载的script return { l: script\_len, //长度，用于生成id用 z: get\_attribute(script, "zIndex", -1), //z-index o: get\_attribute(script, "opacity", 0.5), //opacity c: get\_attribute(script, "color", "0,0,0"), //color n: get\_attribute(script, "count", 99) //count }; } //设置canvas的高宽 function set\_canvas\_size() { canvas\_width = the\_canvas.width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth, canvas\_height = the\_canvas.height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight; } //绘制过程 function draw\_canvas() { context.clearRect(0, 0, canvas\_width, canvas\_height); //随机的线条和当前位置联合数组 var e, i, d, x\_dist, y\_dist, dist; //临时节点 //遍历处理每一个点 random\_lines.forEach(function(r, idx) { r.x += r.xa, r.y += r.ya, //移动 r.xa *= r.x > canvas\_width || r.x < 0 ? -1 : 1, r.ya *= r.y > canvas\_height || r.y < 0 ? -1 : 1, //碰到边界，反向反弹 context.fillRect(r.x - 0.5, r.y - 0.5, 1, 1); //绘制一个宽高为1的点 //从下一个点开始 for (i = idx + 1; i < all\_array.length; i++) { e = all\_array\[i\]; //不是当前点 if (null !== e.x && null !== e.y) { x\_dist = r.x - e.x, //x轴距离 l y\_dist = r.y - e.y, //y轴距离 n dist = x\_dist * x\_dist + y\_dist * y\_dist; //总距离, m dist < e.max && (e === current\_point && dist >= e.max / 2 && (r.x -= 0.03 * x\_dist, r.y -= 0.03 * y\_dist), //靠近的时候加速 d = (e.max - dist) / e.max, context.beginPath(), context.lineWidth = d / 2, context.strokeStyle = "rgba(" + config.c + "," + (d + 0.2) + ")", context.moveTo(r.x, r.y), context.lineTo(e.x, e.y), context.stroke()); } } }), frame\_func(draw\_canvas); } //创建画布，并添加到body中 var the\_canvas = document.createElement("canvas"), //画布 config = get\_config\_option(), //配置 canvas\_id = "c\_n" + config.l, //canvas id context = the\_canvas.getContext("2d"), canvas\_width, canvas\_height, frame\_func = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function(func) { window.setTimeout(func, 1000 / 45); }, random = Math.random, current\_point = { x: null, //当前鼠标x y: null, //当前鼠标y max: 20000 }, all\_array; the\_canvas.id = canvas\_id; the\_canvas.style.cssText = "position:fixed;top:0;left:0;z-index:" + config.z + ";opacity:" + config.o; get\_by\_tagname("body")\[0\].appendChild(the\_canvas); //初始化画布大小 set\_canvas\_size(), window.onresize = set\_canvas\_size; //当时鼠标位置存储，离开的时候，释放当前位置信息 window.onmousemove = function(e) { e = e || window.event, current\_point.x = e.clientX, current\_point.y = e.clientY; }, window.onmouseout = function() { current\_point.x = null, current\_point.y = null; }; //随机生成config.n条线位置信息 for (var random\_lines = \[\], i = 0; config.n > i; i++) { var x = random() * canvas\_width, //随机位置 y = random() * canvas\_height, xa = 2 * random() - 1, //随机运动方向 ya = 2 * random() - 1; random\_lines.push({ x: x, y: y, xa: xa, ya: ya, max: 6000 //沾附距离 }); } all\_array = random\_lines.concat(\[current\_point\]); //0.1秒后绘制 setTimeout(function() { draw\_canvas(); }, 100); }();

  **WordPress安装canvas-nest.js方法** 1、保存canvas-nest.js源码添加至网页中<body></body>之间

> <html> <head> ... </head> <body> ... ... ... <script type="text/javascript"src="canvas-nest.min.js"></script> </body </html>

  2、在wordpress后台搜索canvas-nest.js插件进行安装 \[caption id="attachment_14513" align="alignnone" width="1206"\]![wordpress后台搜索canvas-nest插件](http://blog.echo.cool/wp-content/uploads/2018/05/unnamed-file-21.png) wordpress后台搜索canvas-nest插件\[/caption\]   3、在wordpress后台添加插件，上传压缩包，注意要.zip格式 \[caption id="attachment_14519" align="alignnone" width="926"\]![wordpress后台上传canvas-nest压缩包](http://blog.echo.cool/wp-content/uploads/2018/05/unnamed-file-22.png) wordpress后台上传canvas-nest压缩包\[/caption\]